<!DOCTYPE html>
<html>

<head>
  <title>Using the Ajax Function</title>
  <style>
    #ajaxContent {
      padding: 5pt;
      border: 2px dashed lightgray;
    }
  </style>

  <script type="text/javascript">
    $("document").ready(function() {
        getData();
      });
      
      function getData() {
        var settings = {
          method: 'GET',
          dataType: 'jsonp',
          crossDomain: true,
          success: successFn,
          oncomplete: oncomplete
        };

        $.ajax('http://www.lolnas.fi/api/restaurants.json', settings);

      }
      
      function successFn(data) {
          var_temp = 0;
          navigator.geolocation.getCurrentPosition(function(position){
            for (var i = 0; i < data.restaurants.length; i++) {
              _temp = distance(position.coords.latitude, position.coords.longitude, data.restaurants[i].latitude, data.restaurants[i].longitude, 'K');
              console.log('The distance between me and the restaurant ' + data.restaurants[i].data_provider_title + ' is ' + _temp);
            }
            /*
        data.restaurants.forEach(element => {
          $('ajaxContent').append('Restaurant ' + element.data_provider_title +
            'has coordinates of lat = ' + element.latitude + ' and lon =' + element.longitude);
        });

        var distanceBetweenMeAndTheRestaurant = 
        calculateDistance(position, element.latitude,
        element.longitude);
        console.log("Setting result");
        $("#ajaxContent").append(result);*/
      }
      
      function errorFn() {
        console.log('Oops! There was an error');
      }
      function oncomplete() {
        console.log('Operation complete');
      }
      
  </script>
</head>

<body>
  <h1>Using the basic Ajax function</h1>
  <div id="content">

    <p>The <code>$.ajax()</code> function is used to perform basic AJAX requests. It can be customized using a variety of parameters.</p>
    <p>If successful, the returned data will appear here:</p>
    <p id="ajaxContent"></p>
  </div>
</body>

</html>
